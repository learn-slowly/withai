# GitHub Actions를 이용한 index.md 자동 업데이트 구현

## 작업 내용

### update-indexes.yml 파일 수정

1. workflow 트리거 조건 설정
   ```yaml
   on:
     push:
       branches: 
         - main
       paths:
         - 'content-production/**/*.md'
         - 'foreign-lang/**/*.md'
         - 'webdev/**/*.md'
         - '.github/workflows/update-indexes.yml'
   ```
   - 특정 경로의 .md 파일이 변경될 때만 workflow 실행

2. README.md 업데이트 로직 개선
   ```python
   # Finally update README.md
   if os.path.exists('README.md'):
       print("Updating README.md")
       with open('README.md', 'r', encoding='utf-8') as f:
           content = f.read()
       
       # 정규식을 사용하여 마지막 Last updated 줄을 찾아 교체
       pattern = r'#### Last updated: .*?\n'
       new_content = re.sub(pattern, f'#### Last updated: {get_korean_time()}\n', content)
       
       # 파일 쓰기
       with open('README.md', 'w', encoding='utf-8') as f:
           f.write(new_content)
       print("Updated README.md")
   ```

3. index.md 파일 업데이트 로직
   ```python
   def update_index_file(index_path, folder_path, is_foreign_lang=False):
       print(f"Processing {index_path}...")
       
       if not os.path.exists(index_path):
           print(f"Warning: {index_path} does not exist")
           return False
           
       with open(index_path, 'r', encoding='utf-8') as f:
           lines = f.readlines()
           
       new_lines = []
       updated = False
       
       if is_foreign_lang:
           for line in lines:
               if '#### Last updated:' in line:
                   new_lines.append(f'#### Last updated: {get_korean_time()}\n')
                   updated = True
               else:
                   new_lines.append(line)
       else:
           for line in lines:
               if '#### Last updated:' in line:
                   new_lines.append(f'#### Last updated: {get_korean_time()}\n')
                   updated = True
               else:
                   new_lines.append(line)
       
       if updated:
           with open(index_path, 'w', encoding='utf-8') as f:
               f.writelines(new_lines)
           print(f"Updated {index_path}")
           return True
       return False
   ```

## 주요 변경사항
1. 파일 변경 감지 방식 개선
   - git diff를 사용하여 변경된 파일 목록 확인
   - 변경된 파일의 경로에 따라 해당 index.md 파일만 업데이트

2. Last updated 업데이트 로직 개선
   - README.md: 정규식을 사용하여 Last updated 줄을 정확히 찾아 교체
   - index.md: 라인 단위로 처리하여 Last updated 줄 업데이트

3. 실행 순서 최적화
   - 변경된 파일 확인
   - index.md 파일들 업데이트
   - README.md 업데이트
   - 변경사항이 있을 때만 커밋

4. 에러 처리 개선
   - 파일 존재 여부 확인
   - 업데이트 성공 여부 추적
   - 디버깅을 위한 로그 출력 추가

## 결과
- 모든 index.md 파일의 Last updated 시간이 정확히 업데이트됨
- README.md의 Last updated 시간도 올바르게 업데이트됨
- 불필요한 커밋이 발생하지 않음
- 안정적인 파일 처리 및 에러 핸들링

