# GitHub Actions를 이용한 index.md 자동 업데이트 구현

## 작업 내용

### update-indexes.yml 파일 수정

1. workflow 트리거 조건 수정
   ```yaml
   on:
     push:
       branches:
         - main
   ```
   - 모든 main 브랜치 push에 대해 workflow 실행
   - README.md 파일이 항상 업데이트되도록 수정

2. Last updated 중복 제거
   ```python
   # 기존의 Last updated 라인이 있다면 제거
   content = re.sub(r'\n#### Last updated:.*?\n', '', content, flags=re.MULTILINE)
   
   # 컨텐츠 업데이트
   updated_content = content[:h1_end] + time_update + new_links + content[h1_end:]
   
   # 혹시 모를 중복 제거를 위한 추가 처리
   updated_content = re.sub(r'(\n#### Last updated:.*?\n).*?(\n#### Last updated:.*?\n)', r'\2', updated_content, flags=re.DOTALL)
   ```

3. README.md 업데이트 로직 개선
   ```python
   def update_readme():
       # 대소문자 구분 없이 파일 찾기
       for filename in os.listdir('.'):
           if filename.lower() == 'readme.md':
               readme_path = filename
               break
       else:
           return  # README.md 파일을 찾지 못함
       
       with open(readme_path, 'r', encoding='utf-8') as f:
           content = f.read()
       
       current_time = get_korean_time()
       time_update = f"\n#### Last updated: {current_time}\n"
       
       # 파일 끝의 Last updated 찾아서 제거
       content = re.sub(r'\n#### Last updated:.*?$', '', content, flags=re.MULTILINE | re.DOTALL)
       
       # 내용 끝에 불필요한 개행 제거 후 새로운 시간 추가
       updated_content = content.rstrip() + time_update
       
       # 디버깅을 위한 출력
       print(f"Updating {readme_path} with new timestamp")
       
       with open(readme_path, 'w', encoding='utf-8') as f:
           f.write(updated_content)
   ```

4. foreign-lang/index.md 링크 생성 수정
   ```python
   # 새로운 파일 링크 생성 (중복 제외)
   jp_links = ""
   for file in sorted(jp_files, reverse=True):
       date = os.path.splitext(os.path.basename(file))[0]
       if re.match(r'^\d{8}$', date):
           formatted_date = f"{date[:4]}-{date[4:6]}-{date[6:]}"
           if formatted_date not in existing_jp_links:  # 중복 체크
               jp_links += f"\n- [{formatted_date}](jp/{file})\n"
               
   en_links = ""
   for file in sorted(en_files, reverse=True):
       date = os.path.splitext(os.path.basename(file))[0]
       if re.match(r'^\d{8}$', date):
           formatted_date = f"{date[:4]}-{date[4:6]}-{date[6:]}"
           if formatted_date not in existing_en_links:  # 중복 체크
               en_links += f"\n- [{formatted_date}](en/{file})\n"
   ```

## 주요 변경사항
1. workflow 트리거 조건을 모든 main 브랜치 push로 변경
   - 이전: 특정 경로의 .md 파일 변경 시에만 실행
   - 변경: main 브랜치의 모든 push에 대해 실행

2. Last updated 중복 제거 로직 강화
   - 기존 Last updated 라인 제거
   - 새로운 시간 추가
   - 혹시 모를 중복 제거를 위한 추가 정규식 처리

3. README.md 업데이트 개선
   - 대소문자 구분 없이 파일 찾기 기능 추가
   - 정규식 패턴 개선 (`$`로 파일 끝 매칭)
   - 디버깅용 출력 추가
   - 정규식 플래그에 `re.DOTALL` 추가
   - 불필요한 개행 제거 후 시간 업데이트

4. foreign-lang/index.md 링크 생성 개선
   - 중복된 'foreign-lang/' 경로 제거
   - 상대 경로로 변경하여 올바른 링크 생성

